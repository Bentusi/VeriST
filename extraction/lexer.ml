# 1 "lexer.mll"
 
(* ST Language Lexer *)
open Parser

exception Lexer_error of string

let keyword_table = Hashtbl.create 53
let _ =
  Stdlib.List.iter (fun (kwd, tok) -> Hashtbl.add keyword_table kwd tok)
    [
      ("PROGRAM", PROGRAM);
      ("END_PROGRAM", END_PROGRAM);
      ("VAR", VAR);
      ("END_VAR", END_VAR);
      ("IF", IF);
      ("THEN", THEN);
      ("ELSIF", ELSIF);
      ("ELSE", ELSE);
      ("END_IF", END_IF);
      ("WHILE", WHILE);
      ("DO", DO);
      ("END_WHILE", END_WHILE);
      ("FOR", FOR);
      ("TO", TO);
      ("BY", BY);
      ("END_FOR", END_FOR);
      ("CASE", CASE);
      ("OF", OF);
      ("END_CASE", END_CASE);
      ("FUNCTION", FUNCTION);
      ("END_FUNCTION", END_FUNCTION);
      ("RETURN", RETURN);
      ("INT", INT_TYPE);
      ("BOOL", BOOL_TYPE);
      ("TRUE", TRUE);
      ("FALSE", FALSE);
      ("AND", AND);
      ("OR", OR);
      ("NOT", NOT);
      ("MOD", MOD);
    ]

# 45 "lexer.ml"
let __ocaml_lex_tables = {
  Lexing.lex_base =
   "\000\000\231\255\232\255\075\000\150\000\002\000\030\000\240\255\
    \242\255\243\255\244\255\246\255\248\255\249\255\003\000\251\255\
    \046\000\052\000\254\255\002\000\007\000\253\255\252\255\245\255\
    \237\255\239\255\235\255\124\000\252\255\253\255\002\000\254\255\
    \054\000\255\255\008\000\253\255\254\255\004\000\255\255";
  Lexing.lex_backtrk =
   "\255\255\255\255\255\255\022\000\021\000\019\000\017\000\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\005\000\255\255\
    \014\000\008\000\255\255\000\000\000\000\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\003\000\255\255\
    \003\000\255\255\255\255\255\255\255\255\002\000\255\255";
  Lexing.lex_default =
   "\001\000\000\000\000\000\255\255\255\255\255\255\255\255\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\255\255\000\000\
    \255\255\255\255\000\000\255\255\255\255\000\000\000\000\000\000\
    \000\000\000\000\000\000\028\000\000\000\000\000\255\255\000\000\
    \255\255\000\000\035\000\000\000\000\000\255\255\000\000";
  Lexing.lex_trans =
   "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\019\000\018\000\019\000\031\000\020\000\038\000\019\000\
    \019\000\018\000\038\000\000\000\019\000\037\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \019\000\000\000\019\000\000\000\000\000\000\000\000\000\019\000\
    \017\000\011\000\008\000\010\000\013\000\009\000\012\000\016\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\014\000\015\000\006\000\007\000\005\000\026\000\
    \023\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\024\000\025\000\022\000\021\000\033\000\
    \000\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\000\000\031\000\000\000\
    \000\000\030\000\000\000\000\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\032\000\000\000\
    \000\000\000\000\003\000\000\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \002\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \036\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\029\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000";
  Lexing.lex_check =
   "\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\019\000\030\000\000\000\037\000\019\000\
    \020\000\020\000\034\000\255\255\020\000\034\000\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\255\255\019\000\255\255\255\255\255\255\255\255\020\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\005\000\
    \014\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\006\000\006\000\016\000\017\000\032\000\
    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\255\255\027\000\255\255\
    \255\255\027\000\255\255\255\255\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\027\000\255\255\
    \255\255\255\255\003\000\255\255\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \034\000\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\027\000\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255";
  Lexing.lex_base_code =
   "";
  Lexing.lex_backtrk_code =
   "";
  Lexing.lex_default_code =
   "";
  Lexing.lex_trans_code =
   "";
  Lexing.lex_check_code =
   "";
  Lexing.lex_code =
   "";
}

let rec token lexbuf =
   __ocaml_lex_token_rec lexbuf 0
and __ocaml_lex_token_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 51 "lexer.mll"
                    ( token lexbuf )
# 190 "lexer.ml"

  | 1 ->
# 52 "lexer.mll"
                    ( Lexing.new_line lexbuf; token lexbuf )
# 195 "lexer.ml"

  | 2 ->
# 53 "lexer.mll"
                    ( comment lexbuf )
# 200 "lexer.ml"

  | 3 ->
# 54 "lexer.mll"
                    ( line_comment lexbuf )
# 205 "lexer.ml"

  | 4 ->
# 57 "lexer.mll"
                    ( SEMICOLON )
# 210 "lexer.ml"

  | 5 ->
# 58 "lexer.mll"
                    ( COLON )
# 215 "lexer.ml"

  | 6 ->
# 59 "lexer.mll"
                    ( COMMA )
# 220 "lexer.ml"

  | 7 ->
# 60 "lexer.mll"
                    ( DOT )
# 225 "lexer.ml"

  | 8 ->
# 61 "lexer.mll"
                    ( LPAREN )
# 230 "lexer.ml"

  | 9 ->
# 62 "lexer.mll"
                    ( RPAREN )
# 235 "lexer.ml"

  | 10 ->
# 65 "lexer.mll"
                    ( ASSIGN )
# 240 "lexer.ml"

  | 11 ->
# 66 "lexer.mll"
                    ( PLUS )
# 245 "lexer.ml"

  | 12 ->
# 67 "lexer.mll"
                    ( MINUS )
# 250 "lexer.ml"

  | 13 ->
# 68 "lexer.mll"
                    ( TIMES )
# 255 "lexer.ml"

  | 14 ->
# 69 "lexer.mll"
                    ( DIVIDE )
# 260 "lexer.ml"

  | 15 ->
# 72 "lexer.mll"
                    ( EQ )
# 265 "lexer.ml"

  | 16 ->
# 73 "lexer.mll"
                    ( NE )
# 270 "lexer.ml"

  | 17 ->
# 74 "lexer.mll"
                    ( LT )
# 275 "lexer.ml"

  | 18 ->
# 75 "lexer.mll"
                    ( LE )
# 280 "lexer.ml"

  | 19 ->
# 76 "lexer.mll"
                    ( GT )
# 285 "lexer.ml"

  | 20 ->
# 77 "lexer.mll"
                    ( GE )
# 290 "lexer.ml"

  | 21 ->
let
# 80 "lexer.mll"
              n
# 296 "lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 80 "lexer.mll"
                    ( INT (int_of_string n) )
# 300 "lexer.ml"

  | 22 ->
let
# 83 "lexer.mll"
             id
# 306 "lexer.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 83 "lexer.mll"
                    ( 
      try Hashtbl.find keyword_table (Stdlib.String.uppercase_ascii id)
      with Not_found -> IDENT id
    )
# 313 "lexer.ml"

  | 23 ->
# 88 "lexer.mll"
                    ( EOF )
# 318 "lexer.ml"

  | 24 ->
let
# 89 "lexer.mll"
         c
# 324 "lexer.ml"
= Lexing.sub_lexeme_char lexbuf lexbuf.Lexing.lex_start_pos in
# 89 "lexer.mll"
                    ( raise (Lexer_error (Printf.sprintf "Unexpected character: %c" c)) )
# 328 "lexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf;
      __ocaml_lex_token_rec lexbuf __ocaml_lex_state

and comment lexbuf =
   __ocaml_lex_comment_rec lexbuf 27
and __ocaml_lex_comment_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 92 "lexer.mll"
                    ( token lexbuf )
# 340 "lexer.ml"

  | 1 ->
# 93 "lexer.mll"
                    ( Lexing.new_line lexbuf; comment lexbuf )
# 345 "lexer.ml"

  | 2 ->
# 94 "lexer.mll"
                    ( raise (Lexer_error "Unterminated comment") )
# 350 "lexer.ml"

  | 3 ->
# 95 "lexer.mll"
                    ( comment lexbuf )
# 355 "lexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf;
      __ocaml_lex_comment_rec lexbuf __ocaml_lex_state

and line_comment lexbuf =
   __ocaml_lex_line_comment_rec lexbuf 34
and __ocaml_lex_line_comment_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 98 "lexer.mll"
                    ( Lexing.new_line lexbuf; token lexbuf )
# 367 "lexer.ml"

  | 1 ->
# 99 "lexer.mll"
                    ( EOF )
# 372 "lexer.ml"

  | 2 ->
# 100 "lexer.mll"
                    ( line_comment lexbuf )
# 377 "lexer.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf;
      __ocaml_lex_line_comment_rec lexbuf __ocaml_lex_state

;;

